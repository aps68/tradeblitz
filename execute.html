<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="TradeBlitz Dashboard - Trade Execution">
    <title>Execute | TradeBlitz Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;600;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="glow-orb orb-1"></div>
    <div class="glow-orb orb-2"></div>
    <div class="grid-overlay"></div>

    <nav id="navbar" class="scrolled">
        <div class="nav-container">
            <div class="logo">
                <span class="logo-text">TradeBlitz Dashboard</span>
            </div>
            <div class="nav-links">
                <a href="prep.html">Daily Prep</a>
                <a href="execute.html" class="active" style="color: #fff;">Execute</a>
                <a href="journal.html">Journal</a>
                <a href="tradingclass.html">Trading Class</a>
                <a href="chat.html">AI Chat</a>
            </div>
            <a href="index.html" class="btn-nav">Log Out</a>
        </div>
    </nav>

    <section class="routine-section" style="padding-top: 10rem; min-height: 100vh;">
        <div class="container">
            <h2 class="section-title">Trade Execution âš¡</h2>
            <p class="section-subtitle">Auto position sizing, 1-click execution, and automatic bracket orders.</p>

            <div class="dashboard-grid"
                style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 2rem; margin-top: 3rem;">

                <!-- Position Sizer Form -->
                <div class="glass-panel"
                    style="padding: 2.5rem; border-radius: 16px; background: #0b0d17; border-top: 4px solid #3b82f6;">
                    <h3 style="font-size: 1.5rem; color: #fff; margin-bottom: 1rem; font-family: var(--font-heading);">
                        <span style="margin-right:0.5rem">ðŸ§®</span> Risk Calculator
                    </h3>

                    <div
                        style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); padding: 1rem; border-radius: 8px; margin-bottom: 2rem; color: #f87171; font-weight: 600; font-size: 0.95rem; text-align: center; text-transform: uppercase;">
                        CONDITIONS: Risk only 1% per trade. Daily 2 trades only.
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                        <div>
                            <label
                                style="color: #94a3b8; font-size: 0.85rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase;">Account
                                Balance ($)</label>
                            <input type="number" id="accBalance" value="100000"
                                style="width:100%; padding: 1.2rem; background: #05060a; border: 1px solid rgba(255,255,255,0.1); border-radius:8px; color:#fff; font-size:1.1rem; margin-top:0.5rem; outline: none; transition: 0.3s; font-family: 'Inter', sans-serif;">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div>
                                <label
                                    style="color: #94a3b8; font-size: 0.85rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase;">Risk
                                    (%)</label>
                                <input type="number" id="riskPercent" value="1" step="0.1"
                                    style="width:100%; padding: 1.2rem; background: #05060a; border: 1px solid rgba(255,255,255,0.1); border-radius:8px; color:#fff; font-size:1.1rem; margin-top:0.5rem; outline: none;">
                            </div>
                            <div>
                                <label
                                    style="color: #94a3b8; font-size: 0.85rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase;">Risk
                                    ($)</label>
                                <input type="number" id="riskAmount" readonly
                                    style="width:100%; padding: 1.2rem; background: #12141f; border: 1px solid rgba(239, 68, 68, 0.3); border-radius:8px; color:#ef4444; font-size:1.1rem; margin-top:0.5rem; font-weight:bold; outline: none;">
                            </div>
                        </div>

                        <div>
                            <label
                                style="color: #94a3b8; font-size: 0.85rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase;">Candle
                                Size (Points) - XAUUSD</label>
                            <input type="number" id="slPoints" value="23.5" step="0.1"
                                style="width:100%; padding: 1.2rem; background: #05060a; border: 1px solid rgba(255,255,255,0.1); border-radius:8px; color:#fff; font-size:1.1rem; margin-top:0.5rem; outline: none;">
                        </div>
                    </div>
                </div>

                <!-- Execution Terminal -->
                <div class="glass-panel"
                    style="padding: 2.5rem; border-radius: 16px; background: #0b0d17; display: flex; flex-direction: column; position: relative; overflow: hidden;">
                    <h3
                        style="font-size: 1.5rem; color: #fff; margin-bottom: 1.5rem; font-family: var(--font-heading);">
                        <span style="margin-right:0.5rem">âš¡</span> 1-Click Terminal
                    </h3>

                    <div
                        style="background: #12141f; border: 1px solid rgba(255,255,255,0.05); border-radius: 12px; padding: 2.5rem; text-align: center; flex-grow: 1; display: flex; flex-direction: column; justify-content: center;">

                        <div
                            style="font-size: 1rem; font-weight: 700; letter-spacing: 1.5px; color: #94a3b8; margin-bottom: 0.5rem; text-transform: uppercase;">
                            Calculate Position Size</div>
                        <div id="lotSizeDisplay"
                            style="font-size: 5rem; font-weight: 800; color: #10b981; font-family: var(--font-heading); line-height: 1;">
                            0.00</div>
                        <div style="color: #64748b; margin-top: 0.5rem; margin-bottom: 2rem;">Lots XAUUSD</div>




                    </div>
                </div>
            </div>
    </section>

    <script>
        const accBalanceInput = document.getElementById('accBalance');
        const riskPercentInput = document.getElementById('riskPercent');
        const slPointsInput = document.getElementById('slPoints');
        const riskAmountInput = document.getElementById('riskAmount');
        const lotSizeDisplay = document.getElementById('lotSizeDisplay');
        const inputs = [accBalanceInput, riskPercentInput, slPointsInput];

        function calculateSize() {
            const balance = parseFloat(accBalanceInput.value) || 0;
            const riskPct = parseFloat(riskPercentInput.value) || 0;
            const slPts = parseFloat(slPointsInput.value) || 0;

            const riskDist = balance * (riskPct / 100);
            riskAmountInput.value = riskDist.toFixed(2);

            if (slPts > 0) {
                // XAUUSD mapping: 1 point move (e.g. 2000.00 to 2001.00) on 1 Standard Lot = $100 Profit/Loss
                let lots = riskDist / (slPts * 100);
                // Round down to the nearest 0.01 to ensure risk is never exceeded
                lots = Math.floor(lots * 100) / 100;

                if (lots <= 0) {
                    lotSizeDisplay.innerText = "DON'T TAKE TRADE";
                    lotSizeDisplay.style.color = '#ef4444';
                    lotSizeDisplay.style.fontSize = '2.5rem';
                } else {
                    lotSizeDisplay.innerText = lots.toFixed(2);
                    lotSizeDisplay.style.color = '#10b981'; // green if valid
                    lotSizeDisplay.style.fontSize = '5rem';
                }
            } else {
                lotSizeDisplay.innerText = "DON'T TAKE TRADE";
                lotSizeDisplay.style.color = '#ef4444'; // red if invalid
                lotSizeDisplay.style.fontSize = '2.5rem';
            }
        }

        inputs.forEach(input => {
            input.addEventListener('input', calculateSize);
        });

    </script>
    <!-- Admin Login Modal -->
    <div id="adminModal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; justify-content: center; align-items: center; backdrop-filter: blur(5px);">
        <div class="glass-panel"
            style="background: #0b0d17; padding: 2.5rem; border-radius: 16px; width: 100%; max-width: 400px; border-top: 4px solid #f59e0b; position: relative;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h3 style="color: #fff; font-family: var(--font-heading); font-size: 1.5rem; margin: 0;">Admin Login
                </h3>
                <button onclick="document.getElementById('adminModal').style.display='none'"
                    style="background: transparent; border: none; color: #64748b; font-size: 2rem; cursor: pointer; padding: 0; line-height: 1;">&times;</button>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <label style="color: #94a3b8; font-size: 0.85rem; font-weight: 700; text-transform: uppercase;">Admin
                    ID</label>
                <input type="email" id="adminId" placeholder="Admin ID"
                    style="width: 100%; padding: 1rem; background: #05060a; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #fff; margin-top: 0.5rem; outline: none; box-sizing: border-box;">
            </div>

            <div style="margin-bottom: 2rem;">
                <label
                    style="color: #94a3b8; font-size: 0.85rem; font-weight: 700; text-transform: uppercase;">Password</label>
                <input type="password" id="adminPass" placeholder="Password"
                    style="width: 100%; padding: 1rem; background: #05060a; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #fff; margin-top: 0.5rem; outline: none; box-sizing: border-box;">
            </div>

            <button onclick="adminLogin()"
                style="width: 100%; background: #f59e0b; color: #000; font-weight: 800; border: none; padding: 1.2rem; border-radius: 8px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;">Access
                Dashboard</button>
            <div id="adminError"
                style="color: #ef4444; font-size: 0.85rem; margin-top: 1rem; text-align: center; display: none;">Invalid
                ID or Password.</div>
        </div>
    </div>

    <script>
        function adminLogin() {
            const id = document.getElementById('adminId').value.trim();
            const pass = document.getElementById('adminPass').value.trim();

            if (id === 'akshaypayakkal@gmail.com' && pass === '111198125') {
                window.location.href = 'admin.html';
            } else {
                document.getElementById('adminError').style.display = 'block';
            }
        }
    </script>

    <!-- Ambient BGM Player -->
    <audio id="bgmAudio" loop preload="auto">
        <source src="background.mp3" type="audio/mpeg">
    </audio>
    <button id="bgmToggle" title="Toggle Ambient Music" style="position: fixed; bottom: 20px; left: 20px; z-index: 9999; background: rgba(11, 13, 23, 0.8); border: 1px solid rgba(255,255,255,0.1); padding: 12px; border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; backdrop-filter: blur(10px); transition: 0.3s; color: #64748b;">
        <svg id="bgmIcon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <line id="muteLine1" x1="23" y1="9" x2="17" y2="15"></line>
            <line id="muteLine2" x1="17" y1="9" x2="23" y2="15"></line>
        </svg>
    </button>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const audio = document.getElementById("bgmAudio");
            const toggleBtn = document.getElementById("bgmToggle");
            const icon = document.getElementById("bgmIcon");
            
            audio.volume = 0.4; // Default half volume

            // Restore time & play state across pages
            const savedTime = localStorage.getItem("tradeblitz_bgm_time");
            const isPlaying = localStorage.getItem("tradeblitz_bgm_playing") === "true";
            
            if (savedTime) audio.currentTime = parseFloat(savedTime);

            function setPlayingUI() {
                icon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>';
                toggleBtn.style.color = "#10b981";
                toggleBtn.style.borderColor = "rgba(16, 185, 129, 0.3)";
                toggleBtn.style.boxShadow = "0 0 10px rgba(16, 185, 129, 0.2)";
            }
            
            function setMutedUI() {
                icon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line>';
                toggleBtn.style.color = "#ef4444";
                toggleBtn.style.borderColor = "rgba(239, 68, 68, 0.3)";
                toggleBtn.style.boxShadow = "none";
            }

            if (isPlaying) {
                // Browsers might block this, but we try
                audio.play().then(() => setPlayingUI()).catch(e => setMutedUI());
            } else {
                setMutedUI();
            }
            
            // Save time continuously so jumping pages feels seamless
            setInterval(() => {
                if (!audio.paused) {
                    localStorage.setItem("tradeblitz_bgm_time", audio.currentTime);
                }
            }, 1000);
            
            toggleBtn.addEventListener("click", () => {
                if (audio.paused) {
                    audio.play();
                    setPlayingUI();
                    localStorage.setItem("tradeblitz_bgm_playing", "true");
                } else {
                    audio.pause();
                    setMutedUI();
                    localStorage.setItem("tradeblitz_bgm_playing", "false");
                }
            });
            
            // Try playing anyway on first interaction if they left it playing
            document.body.addEventListener("click", () => {
                if (localStorage.getItem("tradeblitz_bgm_playing") === "true" && audio.paused) {
                    audio.play();
                    setPlayingUI();
                }
            }, { once: true });
        });
    </script>
</body>

</html>